
Learn Bhuman


1. SimRobot中的命令行
console

type “dr debugDrawing3d:test3D” into the SimRobot console;

vp and vpd :plot view;

get and set : read and manipulated streamable data;

sl :replay several log files;

dr representation:JPEGImage off
get representation:MotionRequest
save representation:JointCalibration
mr StandOutput CalibrationStand
get representation:JointCalibration 
vd representation:JointCalibration



representation:Modules require a certain input and produce a certain output.

2.数据流
Bhuman序列化程序执行的基础，write : Out  read : In
PhysicalOutStream PhysicalInStream physical media
StreamWriter  StreamWriter
OutStream InStream
OutMap InMap
包含文件位置:Tools/Streams  

3.视觉部分，认知
Perception
BallPercept  LinePercept  GoalPercept  FieldBoundary  ObstacleSpots
CameraInfo : the image comes from which camera

场地坐标系
The global coordinate system is described by its origin lying at the center of the field, the x-axis pointing toward the opponent goal, the y-axis pointing to the left, and the z-axis pointing upward.
机器人坐标系
the robot-relative coordinate system
the x-axis points forward, the y-axis points to the left, and the z-axis points upward.

Pay attention to this:
the camera cannot be mounted perfectly plain and the torso is not always perfectly vertical. A small variation in the camera’s orientation can lead to significant errors when projecting farther objects onto the field.
Bhuman use CameraCalibratorV4 to overcome this problem.

策略：Behavior control
CABSL : the C-based Agent Behavior Specification Language
语法：
options(选项):
states:
transitions(过渡，转变):
actions:

A behavior consists of a set of options that are arranged in an option graph. There is a single starting option from which all other options are called; this is the root of the option graph. Each option is a finite state machine that describes a specific part of the behavior such as a skill or a head motion of the robot, or it combines such basic features. Each option starts with its intital_state. Inside a state, an action can be executed which may call another option as well as execute any C++ code.

common_transition : Common transitions consist of conditions that are checked all the time, independent from the current state.

Libraries: normal C++ class , 继承LibraryBase Libraries.h   
LibraryBase.h  LibraryBase.cpp

创建一个新的行为，copy Src/Modules/BehaviorControl/BehaviorControl2015 into a new folder Src/Modules/BehaviorControl/<NewBehavior>
随后重命名模块的名字，改成你自己设定的名字(包括更改配置文件Config/Location/Default/behavior2013.cfg的名字)，还要更改在cpp文件下面的命名空间的定义。

Special situations:
StopBall  : 传球时让球停下来
TakePass: 前锋通过另外一个机器人，转向球的方向
SearchForBall : 当整个队伍看不到球的时候，场地上的队员向四周转身找球（加上 摇头，点头）
SearchForBallOnOut: 球出界的时候，所有机器人尝试着向场外找球
CheckMirroredPosition: 当所有队员都看不到球的时候，机器人开始转圈，向Mirrored方向找
CheckBallAfterStandup: 机器人跌倒后如果在接近场地中央的时候，起身没有看到球，就会转身，看mirrored球的位置。

场上机器人的角色是由机器人在场地上的相对位置，由TeamCommunications协调，动态分配的。




